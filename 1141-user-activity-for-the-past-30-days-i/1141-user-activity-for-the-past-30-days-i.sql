# Write your MySQL query statement below


# select activity_date as day, count(user_id) as active_users from (
# select distinct user_id, activity_date
# from activity where activity_date <= '2019-07-27') x;


#  select activity_date as day, count(user_id) as active_users from (
# select distinct user_id, activity_date
# from activity where activity_date > DATE_SUB('2019-07-27',INTERVAL 30 DAY)
#  )x group by activity_date;
 
 
SELECT activity_date AS day, COUNT(DISTINCT user_id) AS active_users
FROM Activity
WHERE (activity_date > DATE_SUB("2019-07-27", interval 30 day) AND activity_date <= "2019-07-27")
GROUP BY activity_date;
 
 
 
#  {"headers": ["day", "active_users"], "values": [["2019-07-26", 5], ["2019-07-05", 8], ["2019-07-18", 7], ["2019-07-21", 6], ["2019-07-07", 6], ["2019-07-23", 6], ["2019-07-01", 5], ["2019-07-03", 7], ["2019-07-25", 5], ["2019-07-22", 8], ["2019-07-24", 4], ["2019-07-13", 8], ["2019-06-28", 3], ["2019-07-19", 7], ["2019-07-17", 5], ["2019-06-29", 3], ["2019-07-11", 8], ["2019-07-02", 4], ["2019-07-04", 3], ["2019-07-16", 7], ["2019-07-14", 7], ["2019-07-10", 3], ["2019-07-06", 7], ["2019-07-09", 3], ["2019-07-20", 4], ["2019-06-30", 2], ["2019-07-12", 2], ["2019-06-27", 6], ["2019-07-08", 5], ["2019-07-15", 1]]}
 
 
#  {"headers":["day","active_users"],"values":[["2019-06-28",3],["2019-06-29",3],["2019-06-30",2],["2019-07-01",5],["2019-07-02",4],["2019-07-03",7],["2019-07-04",3],["2019-07-05",8],["2019-07-06",7],["2019-07-07",6],["2019-07-08",5],["2019-07-09",3],["2019-07-10",3],["2019-07-11",8],["2019-07-12",2],["2019-07-13",8],["2019-07-14",7],["2019-07-15",1],["2019-07-16",7],["2019-07-17",5],["2019-07-18",7],["2019-07-19",7],["2019-07-20",4],["2019-07-21",6],["2019-07-22",8],["2019-07-23",6],["2019-07-24",4],["2019-07-25",5],["2019-07-26",5]]}